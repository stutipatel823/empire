{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState } from \"react\";\nimport { useAuthContext } from \"./useAuthContext\";\nexport const useSignup = () => {\n  _s();\n  const [error, setError] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const {\n    dispatch\n  } = useAuthContext();\n  const signup = async (name, email, password) => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      // Step 1: Send request to create a user\n      const response = await fetch(\"/api/users/signup\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          name,\n          email,\n          password\n        })\n      });\n      const json = await response.json();\n      if (!response.ok) {\n        throw new Error(json.error || \"Signup failed\");\n      }\n\n      // Step 2: If user created successfully, create a cart\n      const token = json.token;\n      const cartResponse = await fetch(\"/api/carts/admin\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          userID: json._id\n        })\n      });\n      const cartJSON = await cartResponse.json();\n      if (!cartResponse.ok) {\n        throw new Error(cartJSON.error || \"Cart creation failed\");\n      }\n\n      // Step 4: If user and cart are created successfully, create a wishlist\n      const wishlistResponse = await fetch(\"/api/wishlists/admin\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      });\n\n      // Step 3: Save user and cart in localStorage\n      localStorage.setItem(\"user\", JSON.stringify(json));\n      // localStorage.setItem(\"cart\", JSON.stringify(cartJSON));\n\n      // Step 4: Update AuthContext with the new user and cart\n      dispatch({\n        type: \"LOGIN\",\n        payload: json\n      });\n      setIsLoading(false);\n      return true;\n    } catch (err) {\n      setIsLoading(false);\n      setError(err.message || \"Something went wrong\");\n    }\n  };\n  return {\n    signup,\n    isLoading,\n    error\n  };\n};\n_s(useSignup, \"leglVsSbW4DJnC7nVdCyJFB0GD8=\", false, function () {\n  return [useAuthContext];\n});","map":{"version":3,"names":["useState","useAuthContext","useSignup","_s","error","setError","isLoading","setIsLoading","dispatch","signup","name","email","password","response","fetch","method","headers","body","JSON","stringify","json","ok","Error","token","cartResponse","Authorization","userID","_id","cartJSON","wishlistResponse","localStorage","setItem","type","payload","err","message"],"sources":["/Users/stutipatel/Desktop/MERN/frontend/src/hooks/useSignup.js"],"sourcesContent":["import { useState } from \"react\";\nimport { useAuthContext } from \"./useAuthContext\";\n\nexport const useSignup = () => {\n  const [error, setError] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const { dispatch } = useAuthContext();\n\n  const signup = async (name, email, password) => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      // Step 1: Send request to create a user\n      const response = await fetch(\"/api/users/signup\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ name, email, password }),\n      });\n      const json = await response.json();\n\n      if (!response.ok) {\n        throw new Error(json.error || \"Signup failed\");\n      }\n\n      // Step 2: If user created successfully, create a cart\n      const token = json.token;\n      \n      const cartResponse = await fetch(\"/api/carts/admin\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ userID: json._id }),\n      });\n\n      const cartJSON = await cartResponse.json();\n      if (!cartResponse.ok) {\n        throw new Error(cartJSON.error || \"Cart creation failed\");\n      }\n\n      // Step 4: If user and cart are created successfully, create a wishlist\n      const wishlistResponse = await fetch(\"/api/wishlists/admin\",{\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n\n        }\n      })\n\n      // Step 3: Save user and cart in localStorage\n      localStorage.setItem(\"user\", JSON.stringify(json));\n      // localStorage.setItem(\"cart\", JSON.stringify(cartJSON));\n\n      // Step 4: Update AuthContext with the new user and cart\n      dispatch({ type: \"LOGIN\", payload: json });\n      setIsLoading(false);\n      return true;\n\n    } catch (err) {\n      setIsLoading(false);\n      setError(err.message || \"Something went wrong\");\n    }\n  };\n\n  return { signup, isLoading, error };\n};\n"],"mappings":";AAAA,SAASA,QAAQ,QAAQ,OAAO;AAChC,SAASC,cAAc,QAAQ,kBAAkB;AAEjD,OAAO,MAAMC,SAAS,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC7B,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGL,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACM,SAAS,EAAEC,YAAY,CAAC,GAAGP,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM;IAAEQ;EAAS,CAAC,GAAGP,cAAc,CAAC,CAAC;EAErC,MAAMQ,MAAM,GAAG,MAAAA,CAAOC,IAAI,EAAEC,KAAK,EAAEC,QAAQ,KAAK;IAC9CL,YAAY,CAAC,IAAI,CAAC;IAClBF,QAAQ,CAAC,IAAI,CAAC;IAEd,IAAI;MACF;MACA,MAAMQ,QAAQ,GAAG,MAAMC,KAAK,CAAC,mBAAmB,EAAE;QAChDC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE;QAClB,CAAC;QACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAET,IAAI;UAAEC,KAAK;UAAEC;QAAS,CAAC;MAChD,CAAC,CAAC;MACF,MAAMQ,IAAI,GAAG,MAAMP,QAAQ,CAACO,IAAI,CAAC,CAAC;MAElC,IAAI,CAACP,QAAQ,CAACQ,EAAE,EAAE;QAChB,MAAM,IAAIC,KAAK,CAACF,IAAI,CAAChB,KAAK,IAAI,eAAe,CAAC;MAChD;;MAEA;MACA,MAAMmB,KAAK,GAAGH,IAAI,CAACG,KAAK;MAExB,MAAMC,YAAY,GAAG,MAAMV,KAAK,CAAC,kBAAkB,EAAE;QACnDC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE,kBAAkB;UAClCS,aAAa,EAAE,UAAUF,KAAK;QAChC,CAAC;QACDN,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAEO,MAAM,EAAEN,IAAI,CAACO;QAAI,CAAC;MAC3C,CAAC,CAAC;MAEF,MAAMC,QAAQ,GAAG,MAAMJ,YAAY,CAACJ,IAAI,CAAC,CAAC;MAC1C,IAAI,CAACI,YAAY,CAACH,EAAE,EAAE;QACpB,MAAM,IAAIC,KAAK,CAACM,QAAQ,CAACxB,KAAK,IAAI,sBAAsB,CAAC;MAC3D;;MAEA;MACA,MAAMyB,gBAAgB,GAAG,MAAMf,KAAK,CAAC,sBAAsB,EAAC;QAC1DC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE;QAElB;MACF,CAAC,CAAC;;MAEF;MACAc,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEb,IAAI,CAACC,SAAS,CAACC,IAAI,CAAC,CAAC;MAClD;;MAEA;MACAZ,QAAQ,CAAC;QAAEwB,IAAI,EAAE,OAAO;QAAEC,OAAO,EAAEb;MAAK,CAAC,CAAC;MAC1Cb,YAAY,CAAC,KAAK,CAAC;MACnB,OAAO,IAAI;IAEb,CAAC,CAAC,OAAO2B,GAAG,EAAE;MACZ3B,YAAY,CAAC,KAAK,CAAC;MACnBF,QAAQ,CAAC6B,GAAG,CAACC,OAAO,IAAI,sBAAsB,CAAC;IACjD;EACF,CAAC;EAED,OAAO;IAAE1B,MAAM;IAAEH,SAAS;IAAEF;EAAM,CAAC;AACrC,CAAC;AAACD,EAAA,CAlEWD,SAAS;EAAA,QAGCD,cAAc;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}